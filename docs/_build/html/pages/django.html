

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Django App &mdash; Fantasy Surf League 3.4 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Fantasy Surf League 3.4 documentation" href="../index.html"/>
        <link rel="next" title="User Interface" href="interface.html"/>
        <link rel="prev" title="Database" href="db.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../README.html" class="icon icon-home"> Fantasy Surf League
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#aim">Aim</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#scope">Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#out-of-scope">Out of Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#assumptions">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#time">Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="comp.html">WSL Surf Fantasy Competition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="comp.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="comp.html#data-considerations">Data Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="comp.html#naming-conventions">Naming conventions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="layout.html">Project layout</a><ul>
<li class="toctree-l2"><a class="reference internal" href="layout.html#tree">Tree</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#files">Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="db.html">Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="db.html#create-db">Create DB</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#import-data">Import Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#create-fantasy-picks-table-django-model">Create Fantasy Picks Table (Django Model)</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#creating-view-to-handle-bonus-rounds">Creating &#8220;VIEW&#8221; to handle bonus rounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#create-fantasy-points-table">Create Fantasy Points Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#create-leaderboard">Create Leaderboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#add-running-totals-to-the-leaderboard">Add Running Totals to the Leaderboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#add-event-rank-and-tour-rank-to-the-leaderboard">Add Event Rank and Tour Rank to the Leaderboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#add-change-in-rank-to-the-leaderboard">Add Change in Rank to the Leaderboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#add-required-points-to-the-leaderboard">Add Required Points to the Leaderboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#drop-tables-not-needed-in-the-django-app">Drop tables not needed in the django app</a></li>
<li class="toctree-l2"><a class="reference internal" href="db.html#tables-remaining-django-models">Tables Remaining (Django Models)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Django App</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#app-design">App Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-django-project-and-app">Create Django Project and App</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-django-models-from-sqlite-database">Generate Django Models from SQLite Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database-setup-fantasy-settings-py">Database setup (fantasy/settings.py)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#urls-py-dashboard-app">urls.py (dashboard app)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-user">Create User</a></li>
<li class="toctree-l2"><a class="reference internal" href="#migrate-changes">Migrate Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#added-project-directories">Added Project Directories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modifying-views-py-to-access-querysets">Modifying views.py to Access Querysets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#views-py">views.py</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">User Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="interface.html#queryset">QUERYSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="interface.html#list">LIST</a></li>
<li class="toctree-l2"><a class="reference internal" href="interface.html#value">VALUE</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="updates.html">Updating</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../README.html">Fantasy Surf League</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../README.html">Docs</a> &raquo;</li>
        
      <li>Django App</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pages/django.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="django-app">
<h1>Django App<a class="headerlink" href="#django-app" title="Permalink to this headline">¶</a></h1>
<p>The dashboard was created using Django and deployed on Pythonanywhere.com. Basic HTML and CSS syntax in this dashboard are not covered in this documentation.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Python</li>
<li>Django</li>
<li>HTML</li>
<li>CSS</li>
</ul>
</div>
<div class="section" id="app-design">
<h2>App Design<a class="headerlink" href="#app-design" title="Permalink to this headline">¶</a></h2>
<p>The template for this dashboard started with pen to paper before collecting data. I had listed all the features I wanted to display and I had a rough idea of the layout. The main feature that I wanted to include was a comparison table showing which surfers each player had selected and provide some metric of how well that surfer performed.</p>
<dl class="docutils">
<dt>The final design has four main features:</dt>
<dd><ul class="first last simple">
<li>Information area (e.g current event)</li>
<li>Leaderboard (e.g player rank and position change)</li>
<li>Badges (e.g. lowest/highest points per event)</li>
<li>Picks board (i.e. surfers, results, and selections by players)</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="create-django-project-and-app">
<h2>Create Django Project and App<a class="headerlink" href="#create-django-project-and-app" title="Permalink to this headline">¶</a></h2>
<p>Refer to <a class="reference external" href="https://docs.djangoproject.com/en/1.11/intro/tutorial01/">https://docs.djangoproject.com/en/1.11/intro/tutorial01/</a> for help.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>django-admin startproject fantasy
python3.4 manage.py startapp dashboard
</pre></div>
</div>
</div>
<div class="section" id="generate-django-models-from-sqlite-database">
<h2>Generate Django Models from SQLite Database<a class="headerlink" href="#generate-django-models-from-sqlite-database" title="Permalink to this headline">¶</a></h2>
<p>Copy and paste the database (fantasydb) to the parent directory of the fantasy project. Note that the code generated in models.py was reviewed and modified in several places. For example, several IntegerFields were auto-generated as TextFields.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Generate code for models.py</span>
python3.4 manage.py inspectdb --database<span class="o">=</span>fantasydb &gt; dashboard/models.py
</pre></div>
</div>
</div>
<div class="section" id="database-setup-fantasy-settings-py">
<h2>Database setup (fantasy/settings.py)<a class="headerlink" href="#database-setup-fantasy-settings-py" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
         <span class="s1">&#39;dashboard.apps..DashboardConfig&#39;</span><span class="p">,</span>
         <span class="o">...</span>
<span class="p">]</span>

<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span>
            <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;db.sqlite3&#39;</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="c1"># this is the new db</span>
        <span class="s1">&#39;fantasydb&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span>
            <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;fantasydb&#39;</span><span class="p">),</span>
            <span class="s1">&#39;USER&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;HOST&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PORT&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="urls-py-dashboard-app">
<h2>urls.py (dashboard app)<a class="headerlink" href="#urls-py-dashboard-app" title="Permalink to this headline">¶</a></h2>
<p>I am using two urls. The first url is the homepage that will route the user to the latest data (this functionality is done in views.py). The second url uses an integer in the url to locate the appropriate data. For example, <a class="reference external" href="http://127.0.0.1:8000/dashboard/2">http://127.0.0.1:8000/dashboard/2</a> will redirect the user to the data for the second event.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">),</span>
        <span class="n">url</span><span class="p">(</span><span class="s1">r&#39;^(?P&lt;eventid&gt;[0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">championshiptour</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;championshiptour&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="create-user">
<h2>Create User<a class="headerlink" href="#create-user" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span>python3.4 manage.py createsuperuser
<span class="c1"># Follow prompts</span>
</pre></div>
</div>
</div>
<div class="section" id="migrate-changes">
<h2>Migrate Changes<a class="headerlink" href="#migrate-changes" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span>python3.4 manage.py makemigrations dashboard
python3.4 manage.py migrate
</pre></div>
</div>
</div>
<div class="section" id="added-project-directories">
<h2>Added Project Directories<a class="headerlink" href="#added-project-directories" title="Permalink to this headline">¶</a></h2>
<p>New directories were created inside the dashboard app to store html pages, styling sheets and template filters.</p>
<div class="highlight-rst"><div class="highlight"><pre><span></span>fantasy
│
├── dashboard
│   ├── admin.py
│   ├── apps.py
│   ├── models.py
│   │
│   ├── static #New
│   │   ├── css
│   │   │   └── dashboard.css
│   │   │
│   │   └── img
│   │       ├── images.png
│   │       .
│   │
│   ├── templates #New
│   │   └── dashboard
│   │       └── index.html
│   │
│   ├── templatetags #New
│   │   ├── dashboard_extras.py
│   │   ├── __init__.py
│   │   .
│   │
│   .
│
.
</pre></div>
</div>
</div>
<div class="section" id="modifying-views-py-to-access-querysets">
<h2>Modifying views.py to Access Querysets<a class="headerlink" href="#modifying-views-py-to-access-querysets" title="Permalink to this headline">¶</a></h2>
<p>The dashboard has four main areas that displays different data in different structures (e.g. querysets, dicts, lists).</p>
</div>
<div class="section" id="views-py">
<h2>views.py<a class="headerlink" href="#views-py" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">Max</span><span class="p">,</span> <span class="n">Min</span><span class="p">,</span> <span class="n">Sum</span><span class="p">,</span> <span class="n">Avg</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">FantasyPicks</span><span class="p">,</span> <span class="n">FantasyPointsTable</span><span class="p">,</span> <span class="n">FantasyLeaderBoard</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sends the user to the most recent events page.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get max event id</span>
        <span class="n">maxevent</span> <span class="o">=</span> <span class="n">FantasyLeaderBoard</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">using</span><span class="p">(</span>
          <span class="s1">&#39;fantasydb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">em</span><span class="o">=</span><span class="n">Max</span><span class="p">(</span><span class="s1">&#39;event_id&#39;</span><span class="p">))[</span><span class="s1">&#39;em&#39;</span><span class="p">]</span>

        <span class="c1"># call the processing method to redirect</span>
        <span class="k">return</span> <span class="n">championshiptour</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">maxevent</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">championshiptour</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">eventid</span><span class="p">):</span>
        <span class="c1"># Process data here...</span>
        <span class="c1"># Refer to comment strings in views.py</span>

        <span class="c1"># render page</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;dashboard/index.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="interface.html" class="btn btn-neutral float-right" title="User Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="db.html" class="btn btn-neutral" title="Database" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Ray Blick.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>